<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QRTagAll - Tag Anything. Know Everything.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>

    <style>
        /* Core Colors */
        :root {
            --primary: #0077cc;
            --accent: #00cc88;
            --dark: #2b2b2b;
            --light: #f4f4f4;
            --text: #333333;
            --danger: #ff4444;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--light);
            margin: 0;
            padding: 0;
            color: var(--text);
            font-size: 16px;
        }

        /* Topbar */
        #taglineWrapper {
            text-align: center;
            background: #000;
            color: #fff;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 10px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        #topbarContent {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: auto;
            padding: 0 20px;
        }
        #logoSection a {
            color: #FFA500;
            font-weight: bold;
            text-decoration: none;
            font-size: 22px;
        }
        #taglineSection {
            font-size: clamp(14px, 3vw, 18px);
            color: #ffffff;
        }
        #menuSection {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #menuDropdown button {
            background: none;
            border: none;
            color: white;
            font-size: clamp(20px, 5vw, 26px); /* üî• Larger icon font */
            padding: 8px 14px; /* üî• Bigger click area */
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.2s;
        }

        #menuContent {
            display: none;
            position: absolute;
            right: 0;
            top: 30px;
            background: #fff;
            color: #333;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            min-width: 150px;
            overflow: hidden;
        }
        #menuContent a.menuC {
            font-weight: normal;
            display: block;
            padding: 8px 12px;
            text-decoration: none;
            color: #333;
            white-space: nowrap;
        }
        #menuContent a.menuC:hover {
            background: #f0f0f0;
        }
        p {
            font-size: clamp(15px, 4vw, 17px);
            line-height: 1.7;
            margin-bottom: 20px;
            text-align: justify; /* üî• Make text block-aligned */
        }

        /* Main Area */
        main {
            padding: 100px 20px 40px;
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .intro {
            font-size: clamp(16px, 4vw, 18px);
            line-height: 1.7;
        }
        .intro h2 {
            color: var(--primary);
            margin-bottom: 20px;
        }
        .intro strong {
            color: var(--accent);
        }

        #startBtn {
            background-color: var(--primary);
            border: none;
            padding: 10px 20px;
            color: white;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        #startBtn:hover {
            background-color: #005fa3;
        }

        /* Modal */
        #popupModal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        #popupModalContent {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            width: 320px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            position: relative;
            border-top: 6px solid var(--accent);
        }

        button {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 10px 18px;
            margin: 5px;
            border-radius: 6px;
            font-size: 15px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #00aa77;
        }

        /* Mobile Friendly */
        @media (max-width: 600px) {
            main {
                margin: 100px 10px 20px;
                padding: 20px;
            }
            #topbarContent {
                flex-direction: column;
                gap: 10px;
            }
            #logoSection, #taglineSection, #menuSection {
                text-align: center;
            }
        }


        .closeBtn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 32px; /* üî• Bigger size */
            color: #ff4444;  /* üî• Bright red color */
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        .closeBtn:hover {
            color: #cc0000; /* üî• Darker red on hover */
        }

    </style>

</head>

<body>

<!-- Topbar -->
<div id="taglineWrapper">
    <div id="topbarContent">
        <div id="logoSection">
            <a href="https://qrtagall.com">QRTagAll</a>
        </div>
        <div id="taglineSection">
            Tag Anything. Know Everything.
        </div>
        <div id="menuSection">
            <button id="startBtn">Journey Starts Here ‚Üí</button>
            <div id="menuDropdown">
                <button>‚ò∞</button>
                <div id="menuContent">
                    <a class="menuC" href="https://qrtagall.com">Main Page</a>
                    <a class="menuC" href="/usecases.html">Use Cases</a>
                    <a class="menuC" href="/privacy.html">Privacy Policy</a>
                    <a class="menuC" href="/terms.html">Terms of Service</a>
                    <a class="menuC" href="/about.html">About Us</a>
                    <a class="menuC" href="/contact.html">Contact Us</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Content -->
<main>
    <section class="intro">
        <h2>What is QR-Tag-All?</h2>
        <p><strong>QRTagAll</strong> is a universal digital tagging system that lets you assign a smart identity to <em>any</em> physical object‚Äîbe it a plant, ID card, tool, piece of furniture, or even yourself. With just a QR code, you can claim ownership, upload useful information, and decide exactly what the world sees when they scan it.</p>
        <p>üîπ <strong>For Personal Use:</strong> Use QRTagAll to attach critical information to your belongings. Track warranty cards, purchase bills, repair history, or store emergency contacts. Have a fancy indoor plant? Add care routines accessible via QR. Lost your wallet? Add a recovery message for finders.</p>
        <p>üîπ <strong>For Enterprises:</strong> Whether factory or farm, tag tools, machines, or shipments with QR identity. Attach maintenance logs, compliance docs, sensor data. Track assets from manufacturing to delivery with zero app installs.</p>
        <p>QRTagAll extends to identity tagging for employees, event listings, temporary signage, and beyond. Scalable. Privacy-respecting. No centralized database required.</p>
        <p style="font-weight:bold; font-size:1.3em;">
            Tag it. Own it.
            <a href="https://api.whatsapp.com/send?text=Check%20out%20QRTagAll%20-%20https%3A%2F%2Fqrtagall.com"
               target="_blank"
               style="text-decoration: none; color: inherit;">
                Share it üîÅ
            </a>
        </p>
    </section>
</main>

<!-- Modal for QR generation -->
<!--
<div id="popupModal">
    <div id="popupModalContent">
        <span class="closeBtn" onclick="closeModal()">√ó</span>
        <h3>üéâ Your Universal QR is ready!</h3>
        <p id="qrIdLabel" style="font-size:12px; color:gray;"></p>
        <div id="popupQR" style="margin:20px auto;">
            <canvas id="popupQRCanvas"></canvas>
        </div>
        <button onclick="printQR()">üñ®Ô∏è Print</button>
        <button onclick="goNext()">‚û°Ô∏è Next</button>
    </div>
</div>
-->

<div id="popupModal">
    <div id="popupModalContent">
        <span class="closeBtn" onclick="closeModal()">√ó</span>

        <div id="qrPopupHeading" style="display:block; text-align:center; font-size:20px;  font-weight: bold; color:forestgreen;">

        </div>


        <p id="qrIdLabel" style="font-size:12px;  text-align:center; color:gray;"></p>

        <!-- üîÑ Spinner -->
        <div id="qrSpinner" style="display:none; text-align:center; font-size:22px; font-weight: bold; color:forestgreen;">
            <div class="spinner" style="margin: 10px auto;">‚è≥ Generating Universal QR...</div>
        </div>


        <div id="popupQR" ; style="margin:20px auto;">
            <canvas id="popupQRCanvas" style="display: block; margin: 0 auto;"></canvas>
        </div>

        <!-- üî• New: URL Link -->
        <p id="qrUrl" style="font-size:14px; text-align:center; margin:10px 0;">
            <a id="qrLink" href="#" target="_blank" style="color:#0077cc; word-break:break-all;">Loading link...</a>
        </p>

        <!-- Buttons -->
        <div id="popupButtons" style="margin-top:15px;">
            <button onclick="printQR()">üñ®Ô∏è Print</button>
            <button onclick="goNext()">‚û°Ô∏è Next</button>
            <button onclick="downloadQR()">‚¨áÔ∏è Download</button>
            <button onclick="shareWhatsapp()">üì± WhatsApp</button>

        </div>

    </div>
</div>



<!-- Script Section -->
<script>


    function getReadableTimestamp() {
        const now = new Date();
        const pad = n => n.toString().padStart(2, '0');
        const padMs = n => n.toString().padStart(3, '0');
        return `${now.getFullYear()}${pad(now.getMonth() + 1)}${pad(now.getDate())}${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}${padMs(now.getMilliseconds())}`;
    }




    async function g3n3r4t3_CCCK() {
        const a = ["lo", "xx", "ca", "junk", "tion", "noise"];
        let b = 0;
        const c = a[b] + a[b + 2] + a[b + 4]; // "location"

        const d = ["ho", "yy", "st", "xx", "na", "zz", "me", "extra"];
        let e = 0;
        const f = d[e] + d[e + 2] + d[e + 4] + d[e + 6]; // "hostname"

        const g = window[c][f]; // window["location"]["hostname"]

        const h = Date;
        const i = (new h())["get" + "Time"]();
        const j = Math["f" + "loor"](i / (36 * 100000)); // epoch hour

        // Distractions
        try { crypto.subtle.generateKey({ name: "ECDSA", namedCurve: "P-256" }, true, ["sign", "verify"]).then(() => {}); } catch (_) {}
        try { crypto.subtle.generateKey({ name: "RSASSA-PKCS1-v1_5", modulusLength: 2048, publicExponent: new Uint8Array([1,0,1]), hash: { name: "SHA-256" } }, true, ["sign", "verify"]).then(() => {}); } catch (_) {}

        const k = g + j;
        const l = new TextEncoder();
        const m = l.encode(k);
        const n = await crypto.subtle.digest("SHA-256", m);
        const o = Array.from(new Uint8Array(n)).map(b => b.toString(16).padStart(2, '0')).join('');

        return o;
    }





    const proxyFrame = document.createElement("iframe");
    proxyFrame.style.display = "none";




    proxyFrame.src = "https://proxy.qrtagall.com";
    document.body.appendChild(proxyFrame);

    // Add a flag
    let proxyLoaded = false;


    // Promise-based Generateid() function
    async function Generateid(timestamp) {

        const staticKey = await g3n3r4t3_CCCK()


        return new Promise((resolve, reject) => {

            const handler = (event) => {

                if (!event.data || (event.data.type !== "qr_generated" && event.data.type !== "qr_error")) return;

                window.removeEventListener("message", handler);

                if (event.data.type === "qr_generated") {
                    resolve(event.data.id);
                } else if (event.data.type === "qr_error") {
                    reject(new Error(event.data.error));
                }
            };

            window.addEventListener("message", handler);
            proxyFrame.contentWindow.postMessage(
                {
                    type: "generate",
                    timestamp: timestamp,
                    ccpubkey: staticKey
                }, "*");
        });
    }


    async function generateSecureQR() {
       // const timestamp ="IN_"+ getReadableTimestamp();
        const timestamp =getReadableTimestamp();

        console.log("Timestamp>>>", timestamp);

        // Show spinner
        document.getElementById("qrSpinner").style.display = "block";
        document.getElementById("popupQR").style.display = "none";
        document.getElementById("popupQRCanvas").style.display = "none";
        document.getElementById("qrLink").style.display = "none";
        document.getElementById("qrIdLabel").style.display = "none";

        document.getElementById("popupButtons").style.display = "none";


        document.getElementById("qrPopupHeading").style.display = "none";

        //"qrPopupHeading"

        try {
            const id = await Generateid(timestamp);


            const url = `https://process.qrtagall.com?id=${id}`;

            document.getElementById("qrIdLabel").innerText =  id;

            const canvas = document.getElementById("popupQRCanvas");
            QRCode.toCanvas(canvas, url, { width: 200 }, err => {
                if (err) console.error(err);
            });

            // üî• Also show the URL link
            const linkElem = document.getElementById("qrLink");
            linkElem.href = url;
            linkElem.textContent = url;

            // do whatever next
        } catch (err) {
            //document.querySelector("#qrSpinner .spinner").textContent = "üõ† Error generating QR ID";
            //document.getElementById("qrSpinner").style.color ="red"; // or any CSS color

            console.error("Error generating QR ID:", err);
            // ‚úÖ Show friendly message
            alert("‚ö†Ô∏è QR generating error. Please try again.");

            // ‚úÖ Close the popup modal
            closeModal();

        }

        finally {
            // Hide spinner and show canvas area

            document.getElementById("qrPopupHeading").innerText =  "üéâ Your Universal QR is ready!";
            document.getElementById("qrPopupHeading").style.display = "block";
            document.getElementById("qrSpinner").style.display = "none";
            document.getElementById("popupQR").style.display = "block";
            document.getElementById("popupQRCanvas").style.display = "block";
            document.getElementById("qrLink").style.display = "block";
            document.getElementById("qrIdLabel").style.display = "block";
            document.getElementById("popupButtons").style.display = "block";

        }
    }



    function printQR() {
        const canvas = document.getElementById("popupQRCanvas");
        const win = window.open('', 'Print QR', 'width=400,height=400');
        win.document.write('<img src="' + canvas.toDataURL() + '"/>');
        win.document.close();
        win.print();
    }

    function goNext() {
        const id = document.getElementById("qrIdLabel").innerText.trim();
        if (id) {
            window.location.href = `https://process.qrtagall.com/?id=${id}`;
        } else {
            alert("QR ID not found! Please generate first.");
        }
    }

    function downloadQR() {
        const canvas = document.getElementById("popupQRCanvas");
        const link = document.createElement('a');
        link.href = canvas.toDataURL();
        link.download = 'qrtagall-qr.png';
        link.click();
    }

    // New WhatsApp Share Button
    function shareWhatsapp() {
        const url = document.getElementById("qrLink").href;
        const whatsappUrl = `https://api.whatsapp.com/send?text=Scan this QR link: ${encodeURIComponent(url)}`;
        window.open(whatsappUrl, '_blank');
    }


    function closeModal() {
        document.getElementById("popupModal").style.display = "none";
    }

    document.getElementById("startBtn").onclick = async () => {
        document.getElementById("popupModal").style.display = "flex";
        await generateSecureQR();
    };

    const menuButton = document.querySelector("#menuDropdown > button");
    const menuContent = document.getElementById("menuContent");

    menuButton.addEventListener('click', () => {
        menuContent.style.display = (menuContent.style.display === "block") ? "none" : "block";
    });

    window.addEventListener('click', (e) => {
        if (!document.getElementById('menuDropdown').contains(e.target)) {
            menuContent.style.display = "none";
        }
    });
</script>

</body>
</html>
